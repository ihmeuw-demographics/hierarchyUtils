<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Create a data.tree object to be used for aggregating or scaling
hierarchical categorical or interval data — create_agg_tree • demUtils</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Create a data.tree object to be used for aggregating or scaling
hierarchical categorical or interval data — create_agg_tree" />
<meta property="og:description" content="Creates a hierarchical data.tree object that defines how
different levels of categorical or interval data are related to each other." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">demUtils</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/demUtils.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/placeholder.html">placeholder</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ihmeuw/demUtils/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create a data.tree object to be used for aggregating or scaling
hierarchical categorical or interval data</h1>
    <small class="dont-index">Source: <a href='https://github.com/ihmeuw/demUtils/blob/master/R/categorical_trees.R'><code>R/categorical_trees.R</code></a></small>
    <div class="hidden name"><code>create_tree.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Creates a hierarchical data.tree object that defines how
different levels of categorical or interval data are related to each other.</p>
    </div>

    <pre class="usage"><span class='fu'>create_agg_tree</span>(<span class='no'>mapping</span>, <span class='no'>exists</span>, <span class='no'>col_type</span>)

<span class='fu'>create_scale_tree</span>(<span class='no'>mapping</span>, <span class='no'>exists</span>, <span class='no'>col_type</span>, <span class='kw'>collapse_missing</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)

<span class='fu'>vis_tree</span>(<span class='no'>tree</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mapping</th>
      <td><p>[<code>data.table()</code>]<br />
For 'categorical' variables, defines how different levels of the
hierarchical variable relate to each other. For aggregating 'interval'
variables, it is used to specify intervals to aggregate to, while when
scaling the mapping is inferred from the available intervals in <code>dt</code>.</p></td>
    </tr>
    <tr>
      <th>exists</th>
      <td><p>[<code><a href='https://rdrr.io/r/base/character.html'>character()</a></code>]<br />
names of variables in the mapping that data exists for.</p></td>
    </tr>
    <tr>
      <th>col_type</th>
      <td><p>[<code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code>]<br />
The type of variable that is being aggregated or scaled over. Can be either
'categorical' or 'interval'.</p></td>
    </tr>
    <tr>
      <th>collapse_missing</th>
      <td><p>[<code><a href='https://rdrr.io/r/base/logical.html'>logical(1)</a></code>]<br />
When scaling a <code>categorical</code> variable, whether to collapse missing
intermediate levels in <code>mapping</code>. Default is 'False' and the function
errors out due to missing data.</p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p>[<code>data.tree()</code>] as returned by <code>create_agg_tree()</code> or
<code>create_scale_tree()</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>create_agg_tree()</code> and <code>create_scale_tree()</code> return a
[<code>data.tree()</code>] with fields for whether each node has data available
('exists') and whether aggregation to or scaling of each node is possible
('agg_possible' or 'scale_possible'). For <code>create_scale_tree()</code>, also
includes a field for whether children of each node can be scaled
('scale_children_possible').</p>
<p><code>vis_tree()</code> uses <code><a href='https://rdrr.io/pkg/networkD3/man/diagonalNetwork.html'>networkD3::diagonalNetwork()</a></code> to create 'D3' network
graphs.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><a href='https://en.wikipedia.org/wiki/Tree_(data_structure)'>Hierarchical tree data structures</a>
are used to represent different levels of the categorical or interval data.
The r package <span class="pkg">data.tree</span> is used to implement these data structures.</p>
<p>When <code>vis_tree()</code> is used to visualize a tree returned by <code>create_agg_tree()</code>
then nodes with data directly provided are colored green, nodes where
aggregation is possible are colored blue, and missing nodes without data
directly provided and where aggregation is impossible because of the missing
nodes are colored red.</p>
<p>When <code>vis_tree()</code> is used to visualize a tree returned by
<code>create_scale_tree()</code> then nodes with data directly provided and that can be
scaled are colored green, nodes with data directly provided but that can not
be scaled are colored blue and nodes without data directly provided</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># aggregation example where all present day locations exist except for Tehran</span>
<span class='no'>locations_present</span> <span class='kw'>&lt;-</span> <span class='no'>iran_mapping</span>[!<span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span>(<span class='st'>"[0-9]+"</span>, <span class='no'>child</span>) <span class='kw'>&amp;</span>
                                   <span class='no'>child</span> <span class='kw'>!=</span> <span class='st'>"Tehran"</span>, <span class='no'>child</span>]
<span class='no'>agg_tree</span> <span class='kw'>&lt;-</span> <span class='fu'>create_agg_tree</span>(<span class='no'>iran_mapping</span>, <span class='kw'>exists</span> <span class='kw'>=</span> <span class='no'>locations_present</span>,
                            <span class='kw'>col_type</span> <span class='kw'>=</span> <span class='st'>"categorical"</span>)
<span class='fu'>vis_tree</span>(<span class='no'>agg_tree</span>)

<span class='co'># scaling example where all present day locations exist without collapsing</span>
<span class='no'>locations_present</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>iran_mapping</span>[!<span class='fu'><a href='https://rdrr.io/r/base/grep.html'>grepl</a></span>(<span class='st'>"[0-9]+"</span>, <span class='no'>child</span>), <span class='no'>child</span>], <span class='st'>"Iran"</span>)
<span class='no'>scale_tree</span> <span class='kw'>&lt;-</span> <span class='fu'>create_scale_tree</span>(<span class='no'>iran_mapping</span>,
                                <span class='kw'>exists</span> <span class='kw'>=</span> <span class='no'>locations_present</span>,
                                <span class='kw'>col_type</span> <span class='kw'>=</span> <span class='st'>"categorical"</span>)
<span class='fu'>vis_tree</span>(<span class='no'>scale_tree</span>)

<span class='co'># scaling example where all present day locations exist and collapsing tree</span>
<span class='no'>scale_tree</span> <span class='kw'>&lt;-</span> <span class='fu'>create_scale_tree</span>(<span class='no'>iran_mapping</span>,
                                <span class='kw'>exists</span> <span class='kw'>=</span> <span class='no'>locations_present</span>,
                                <span class='kw'>col_type</span> <span class='kw'>=</span> <span class='st'>"categorical"</span>,
                                <span class='kw'>collapse</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='fu'>vis_tree</span>(<span class='no'>scale_tree</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Charlton Callender, Grant Nguyen, Katie Paulson, Spencer Pease, Haidong Wang, Institute for Health Metrics and Evaluation.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


